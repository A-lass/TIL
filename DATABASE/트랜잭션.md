# 트랜잭션
> 단일한 논리적인 작업 단위

### 트랜잭션을 정의하는 이유
1. 데이터베이스에서 데이터를 다룰 때 장애가 발생하는 경우가 있다. 트랜잭션은 장애 발생 시 데이터를 복구하는 작업의 단위가 된다.
2. 데이터베이스에서 여러 작업이 동시에 같은 데이터를 다룰 때가 있다. 트랜잭션은 이 작업들을 서로 분리하는 단위가 된다.

### COMMIT
* 지금까지 작업한 내용을 DB에 영구적으로(permanently) 저장하고 트랜잭션을 종료한다

### ROLLBACK
* 지금까지 작업한 내용을 모두 취소하고 트랜잭션 이전의 상태로 되돌린다

### AUTOCOMMIT
* 각각의 SQL문을 자동으로 트랜잭션으로 처리해준다  
* SQL문이 성공적으로 실행되면 자동으로 커밋한다  
* 실행 중 문제가 발생하면 알아서 롤백한다  
* MySQL에서는 AUTOCOMMIT이 default로 설정되어 있다  

<br/><br/>

# ACID
### Atomicity (원자성)
* 트랜잭션에 포함된 작업은 전부 수행되거나 전부 수행되지 않아야 한다 (all or nothing)

### Consistency (일관성)
* 트랜잭션을 수행하기 전이나 수행한 후나 데이터베이스는 일관된 상태를 유지해야 한다  
* 일관성은 테이블이 생성될 때 `CREATE`문과 `ALTER`문의 무결성 제약조건을 통해 명시된다  
* 애플리케이션 관점에서 트랜잭션이 일관성 있게 동작하는지는 개발자가 챙겨야 한다

### Isolation (고립성)
* 각 트랜잭션은 다른 트랜잭션의 영향을 받지 않고 독립적으로 수행된다
* DBMS는 여러 종류의 isolation level을 제공한다

### Durability (지속성)
* 커밋된 트랜잭션은 DB에 영구적으로 저장된다

<br/><br/>

# 트랜잭션 격리 수준 (Isolation level)
> 여러 트랜잭션이 동시에 처리될 때 특정 트랜잭션이 다른 트랜잭션에서 변경하거나 조회하는 데이터를 볼 수 있게 허용할지 말지 결정하는 것
### READ UNCOMMITED
* 각 트랜잭션에서의 변경 내용이 COMMIT이나 ROLLBACK 여부에 상관없이 다른 트랜잭션에서 보이게 됨

### READ COMMITED
* 어떤 트랜잭션에서 데이터를 변경했더라도 COMMIT이 완료된 데이터만 다른 트랜잭션에서 조회 가능  
* 오라클 DBMS에서 기본으로 사용되는 격리 수준  

### REPEATABLE READ
* MVCC(Multi Version Concurrency Control)을 위해 언두 영역에 백업된 이전 데이터를 이용해 동일 트랜잭션 내에서는  동일한 결과를 보여줄 수 있게 보장
* MySQL의 InnoDB 스토리지 엔진에서 기본으로 사용되는 격리 수준  

### SERIALIZABLE
* 한 트랜잭션에서 읽고 쓰는 레코드를 다른 트랙잭션에서는 절대 접근할 수 없음
* 가장 단순한 격리수준이면서 동시에 가장 엄격한 격리 수준인 만큼 동시 처리 성능도 다른 트랜잭션 격리 수준보다 떨어짐

||Dirty Read|Non-Repeatable Read|Phantom Read|
|:---:|:---:|:---:|:---:|
|**READ UNCOMMITED**|✔️|✔️|✔️|
|**READ COMMITED**|❌|✔️|✔️|
|**REPEATABLE READ**|❌|❌|✔️|
|**SERIALIZABLE**|❌|❌|❌|
